(window.webpackJsonp=window.webpackJsonp||[]).push([[12],{169:function(t,e,s){"use strict";s.r(e);var r=s(0),a=Object(r.a)({},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"content"},[t._m(0),t._v(" "),t._m(1),t._v(" "),s("p",[t._v("主要在介绍FreeSql在ASP.NTE Core WebApi中如何使用的过程，完成一个最简单的博客系统的后端接口。")]),t._v(" "),t._m(2),t._v(" "),s("p",[t._v("国人写的一个功能强大的ORM,FreeSql 支持 MySql/SqlServer/PostgreSQL/Oracle/Sqlite，特点：轻量级、可扩展、基于 .NET Standard 跨平台。")]),t._v(" "),t._m(3),t._v(" "),s("p",[t._v("代码托管在GitHub上 "),s("a",{attrs:{href:"https://github.com/luoyunchong/dotnetcore-examples/tree/master/asp.net-core-freesql",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/luoyunchong/dotnetcore-examples/tree/master/asp.net-core-freesql"),s("OutboundLink")],1)]),t._v(" "),t._m(4),t._v(" "),s("ul",[s("li",[t._v("FreeSql github "),s("a",{attrs:{href:"https://github.com/2881099/FreeSql",target:"_blank",rel:"noopener noreferrer"}},[t._v("https://github.com/2881099/FreeSql"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/dotnet/core/tools/dotnet-new?tabs=netcore22",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于.net core cli中如何使用dotnet new"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/aspnet/core/web-api/?view=aspnetcore-2.2",target:"_blank",rel:"noopener noreferrer"}},[t._v("使用 ASP.NET Core 创建 Web API"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://docs.microsoft.com/zh-cn/aspnet/core/tutorials/web-api-help-pages-using-swagger?view=aspnetcore-2.2",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swagger/OpenAPI 生成接口文档"),s("OutboundLink")],1)]),t._v(" "),s("li",[s("a",{attrs:{href:"https://github.com/domaindrivendev/Swashbuckle.AspNetCore",target:"_blank",rel:"noopener noreferrer"}},[t._v("Swagger GitHub (Swashbuckle.AspNetCore)"),s("OutboundLink")],1)])]),t._v(" "),t._m(5),t._v(" "),t._m(6),t._v(" "),t._m(7),t._v(" "),s("p",[t._v("使用dotnet 命令行创建一个webapi项目，起名为RESTful.FreeSql")]),t._v(" "),t._m(8),s("p",[t._v("然后cd 到RESTful.FreeSql目录，通过dotnet run 命令运行项目")]),t._v(" "),t._m(9),s("p",[t._v("打开浏览器 https://localhost:5001 会出现404")]),t._v(" "),s("p",[t._v("请打开这个地址 https://localhost:5001/api/values ，可看到如下内容。")]),t._v(" "),t._m(10),s("p",[t._v("接下来我们来集成FreeSql，我们以最简单的命令和说明，详细内容去官网看具体内容")]),t._v(" "),s("ul",[s("li",[t._v("官网文档 "),s("a",{attrs:{href:"http://freesql.net/doc",target:"_blank",rel:"noopener noreferrer"}},[t._v("http://freesql.net/doc"),s("OutboundLink")],1)])]),t._v(" "),t._m(11),t._v(" "),s("p",[t._v("要先cd到RESTful.FreeSql目录中。")]),t._v(" "),t._m(12),t._m(13),t._v(" "),s("ul",[s("li",[s("a",{attrs:{href:"https://github.com/2881099/FreeSql/blob/master/Docs/codefirst.md",target:"_blank",rel:"noopener noreferrer"}},[t._v("关于CodeFirst，官方文档的介绍"),s("OutboundLink")],1)])]),t._v(" "),s("p",[t._v("代码优先，使用过EntityFramework的应该很清楚这一概念，我的理解就是：在分析数据库表关系时，不通过在数据库中设计表，而是直接在代码中声明对应的类，使用导航属性代替外键关联，通过数据表字段与C#中的类库对应，从而自动生成数据表。")]),t._v(" "),t._m(14),t._v(" "),s("p",[t._v("数据库优先：需求分析后，直接设计数据库，通过数据库中的表，直接生成代码，类。")]),t._v(" "),t._m(15),t._v(" "),t._m(16),t._v(" "),s("p",[t._v("我们以code first 为示例，学习如何使用freesql，实现一个简单的博客。将表内容分为博客表（Blog)和评论表（Post)")]),t._v(" "),t._m(17),t._v(" "),t._m(18),t._v(" "),t._m(19),t._v(" "),t._m(20),t._v(" "),s("p",[t._v("建一个Domain文件夹,用于存放数据库表中对应的实体类。")]),t._v(" "),t._m(21),t._v(" "),s("h4",{attrs:{id:"_1-column属性介绍，大家可以看源码，解析"}},[s("a",{staticClass:"header-anchor",attrs:{href:"#_1-column属性介绍，大家可以看源码，解析","aria-hidden":"true"}},[t._v("#")]),t._v(" 1. Column属性介绍，大家可以看"),s("a",{attrs:{href:"https://github.com/2881099/FreeSql/blob/f8c3608fdac2933b528605cc46b21b71c79eaacb/FreeSql/DataAnnotations/ColumnAttribute.cs",target:"_blank",rel:"noopener noreferrer"}},[t._v("源码，解析"),s("OutboundLink")],1)]),t._v(" "),s("p",[t._v("1). 比如：Blog表中指定了Title为varchar(50),我们如何通过代码指定了主键，唯一值，字形。")]),t._v(" "),t._m(22),s("p",[t._v("2). Column的命名空间在")]),t._v(" "),t._m(23),s("p",[t._v("更多属性介绍")]),t._v(" "),t._m(24),t._v(" "),t._m(25),t._v(" "),t._m(26),s("p",[t._v("更多属性介绍")]),t._v(" "),t._m(27),t._v(" "),t._m(28),t._v(" "),t._m(29),t._v(" "),t._m(30),t._m(31),t._v(" "),t._m(32),t._m(33),t._v(" "),t._m(34),t._v(" "),s("p",[t._v("这里初始化FreeSql，并使用单例模式，注入到默认的依赖中，这样在Controller中即可直接注入。")]),t._v(" "),t._m(35),t._m(36),t._v(" "),s("p",[t._v("在controllers文件夹新建一个控制器BlogController")]),t._v(" "),t._m(37),s("p",[t._v("重新运行，打开地址 http://localhost:5001/api/blog 会发现数据库中生成了表blog，这时候表post并没有生成。所以我们判断，只有在访问到实体类才检查是否存在表结构，然后执行相应的处理。")]),t._v(" "),s("p",[t._v("手动向blog表中加一些数据，然后再次请求")]),t._v(" "),t._m(38),t._v(" "),t._m(39),t._v(" "),s("p",[t._v("此功能默认为开启状态，发布正式环境后，请修改此设置")]),t._v(" "),t._m(40),s("RightMenu")],1)},[function(){var t=this.$createElement,e=this._self._c||t;return e("h1",{attrs:{id:"freesql-asp-net-core"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#freesql-asp-net-core","aria-hidden":"true"}},[this._v("#")]),this._v(" FreeSql+ASP.NET Core")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"文章概述"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#文章概述","aria-hidden":"true"}},[this._v("#")]),this._v(" 文章概述")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"freesql-简介"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#freesql-简介","aria-hidden":"true"}},[this._v("#")]),this._v(" FreeSql 简介")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"源码"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#源码","aria-hidden":"true"}},[this._v("#")]),this._v(" 源码")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"参考"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#参考","aria-hidden":"true"}},[this._v("#")]),this._v(" 参考")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"项目准备"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#项目准备","aria-hidden":"true"}},[this._v("#")]),this._v(" 项目准备")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("ul",[s("li",[t._v("Mysql 5.6")]),t._v(" "),s("li",[t._v("Visual Studio 2019或2017、Visual Studio code")]),t._v(" "),s("li",[t._v(".NET Core 2.2+")]),t._v(" "),s("li",[t._v("PowerShell")]),t._v(" "),s("li",[t._v("懂点mvc，该教程不会教你如何使用 ASP .NET Core MVC、RESTful")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"创建项目"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#创建项目","aria-hidden":"true"}},[this._v("#")]),this._v(" 创建项目")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('PS dotnetcore-examples\\asp.net-core-freesql> dotnet new webapi -n RESTful.FreeSql\nThe template "ASP.NET Core Web API" was created successfully.\n')])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-PowerShell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" dotnetcore"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("examples\\asp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("freesql> cd "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\\RESTful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreeSql\\\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" dotnetcore"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("examples\\asp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("freesql\\RESTful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreeSql> dotnet run\n\ninfo: Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hosting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lifetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      Now listening on: https:"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("localhost:5001\ninfo: Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hosting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lifetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      Now listening on: http:"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("/")]),t._v("localhost:5000\ninfo: Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hosting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lifetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      Application started"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v(" Press Ctrl"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("+")]),t._v("C to shut down"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("\ninfo: Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hosting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lifetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      Hosting environment: Development\ninfo: Microsoft"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Hosting"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Lifetime"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),t._v("0"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n      Content root path: D:\\code\\github\\dotnetcore"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("examples\\asp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("freesql\\RESTful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreeSql\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('["value1","value2"]\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"install"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#install","aria-hidden":"true"}},[this._v("#")]),this._v(" Install")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-PowerShell extra-class"},[s("pre",{pre:!0,attrs:{class:"language-powershell"}},[s("code",[s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" \\asp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("freesql\\RESTful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreeSql> dotnet add package FreeSql\n"),s("span",{pre:!0,attrs:{class:"token function"}},[t._v("PS")]),t._v(" \\asp"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("net"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("core"),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("-")]),t._v("freesql\\RESTful"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("FreeSql> dotnet add package FreeSql"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("Provider"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(".")]),t._v("MySql\n")])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"code-first"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#code-first","aria-hidden":"true"}},[this._v("#")]),this._v(" code first")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"db-first"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#db-first","aria-hidden":"true"}},[this._v("#")]),this._v(" db first")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h2",{attrs:{id:"开始"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#开始","aria-hidden":"true"}},[this._v("#")]),this._v(" 开始")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"分析需求"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#分析需求","aria-hidden":"true"}},[this._v("#")]),this._v(" 分析需求")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"blog-表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#blog-表","aria-hidden":"true"}},[this._v("#")]),this._v(" Blog 表")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("字段名")]),t._v(" "),s("th",[t._v("字段类型")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("BlogId")]),t._v(" "),s("td",[t._v("int")]),t._v(" "),s("td",[t._v("博客id")])]),t._v(" "),s("tr",[s("td",[t._v("Title")]),t._v(" "),s("td",[t._v("varchar(50)")]),t._v(" "),s("td",[t._v("博客标题")])]),t._v(" "),s("tr",[s("td",[t._v("Content")]),t._v(" "),s("td",[t._v("varchar(500)")]),t._v(" "),s("td",[t._v("博客内容")])]),t._v(" "),s("tr",[s("td",[t._v("CreateTime")]),t._v(" "),s("td",[t._v("DateTime")]),t._v(" "),s("td",[t._v("发布时间")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"post-表"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#post-表","aria-hidden":"true"}},[this._v("#")]),this._v(" Post 表")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("字段名")]),t._v(" "),s("th",[t._v("字段类型")]),t._v(" "),s("th",[t._v("说明")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("PostId")]),t._v(" "),s("td",[t._v("int")]),t._v(" "),s("td",[t._v("评论id")])]),t._v(" "),s("tr",[s("td",[t._v("ReplyContent")]),t._v(" "),s("td",[t._v("varchar(50)")]),t._v(" "),s("td",[t._v("标题")])]),t._v(" "),s("tr",[s("td",[t._v("BlogId")]),t._v(" "),s("td",[t._v("int")]),t._v(" "),s("td",[t._v("博客id")])]),t._v(" "),s("tr",[s("td",[t._v("ReplyTime")]),t._v(" "),s("td",[t._v("DateTime")]),t._v(" "),s("td",[t._v("回复时间")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"基础介绍"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#基础介绍","aria-hidden":"true"}},[this._v("#")]),this._v(" 基础介绍")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-c# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('    public class Blog\n    {\n        [Column(IsIdentity = true, IsPrimary = true)]\n        public int BlogId { get; set; }\n        [Column(DbType = "varchar(50)")]\n        public string Title { get; set; }\n    }\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-c# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v("using FreeSql.DataAnnotations;\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("字段")]),t._v(" "),s("th",[t._v("备注")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Name")]),t._v(" "),s("td",[t._v("数据库列名")])]),t._v(" "),s("tr",[s("td",[t._v("OldName")]),t._v(" "),s("td",[t._v("指定数据库旧的列名，修改实体属性命名时，同时设置此参数为修改之前的值，CodeFirst才可以正确修改数据库字段；否则将视为【新增字段】")])]),t._v(" "),s("tr",[s("td",[t._v("DbType")]),t._v(" "),s("td",[t._v("数据库类型，如： varchar(255)")])]),t._v(" "),s("tr",[s("td",[t._v("IsPrimary")]),t._v(" "),s("td",[t._v("主键")])]),t._v(" "),s("tr",[s("td",[t._v("IsIdentity")]),t._v(" "),s("td",[t._v("自增标识")])]),t._v(" "),s("tr",[s("td",[t._v("IsNullable")]),t._v(" "),s("td",[t._v("是否可DBNull")])]),t._v(" "),s("tr",[s("td",[t._v("IsIgnore")]),t._v(" "),s("td",[t._v("忽略此列，不迁移、不插入")])]),t._v(" "),s("tr",[s("td",[t._v("IsVersion")]),t._v(" "),s("td",[t._v("设置行锁（乐观锁）版本号，每次更新累加版本号，若更新整个实体时会附带当前的版本号判断（修改失败时抛出异常）")])]),t._v(" "),s("tr",[s("td",[t._v("DbDefautValue")]),t._v(" "),s("td",[t._v("数据库默认值")])]),t._v(" "),s("tr",[s("td",[t._v("MapType")]),t._v(" "),s("td",[t._v("类型映射，比如：可将 enum 属性映射成 typeof(string)")])]),t._v(" "),s("tr",[s("td",[t._v("Uniques")]),t._v(" "),s("td",[t._v("唯一键，在多个属性指定相同的标识，代表联合键；可使用逗号分割多个 UniqueKey 名。")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_2-table-的使用：用于在类的上面指定这个表的属性"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_2-table-的使用：用于在类的上面指定这个表的属性","aria-hidden":"true"}},[this._v("#")]),this._v(" 2. Table 的使用：用于在类的上面指定这个表的属性")])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("div",{staticClass:"language-csharp extra-class"},[s("pre",{pre:!0,attrs:{class:"language-csharp"}},[s("code",[s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("[")]),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Table")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("(")]),t._v("Name "),s("span",{pre:!0,attrs:{class:"token operator"}},[t._v("=")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token string"}},[t._v('"t_blog"')]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v(")")]),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("]")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("public")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token keyword"}},[t._v("class")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token class-name"}},[t._v("Blog")]),t._v(" "),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("{")]),t._v("\n  "),s("span",{pre:!0,attrs:{class:"token comment"}},[t._v("//...")]),t._v("\n"),s("span",{pre:!0,attrs:{class:"token punctuation"}},[t._v("}")]),t._v("\n")])])])},function(){var t=this,e=t.$createElement,s=t._self._c||e;return s("table",[s("thead",[s("tr",[s("th",[t._v("字段")]),t._v(" "),s("th",[t._v("备注")])])]),t._v(" "),s("tbody",[s("tr",[s("td",[t._v("Name")]),t._v(" "),s("td",[t._v("数据库表名")])]),t._v(" "),s("tr",[s("td",[t._v("OldName")]),t._v(" "),s("td",[t._v("指定数据库旧的表名，修改实体命名时，同时设置此参数为修改之前的值，CodeFirst才可以正确修改数据库表；否则将视为【创建新表】")])]),t._v(" "),s("tr",[s("td",[t._v("SelectFilter")]),t._v(" "),s("td",[t._v("查询过滤SQL，实现类似 a.IsDeleted = 1 功能")])]),t._v(" "),s("tr",[s("td",[t._v("DisableSyncStructure")]),t._v(" "),s("td",[t._v("禁用 CodeFirst 同步结构迁移")])])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"_3-其他的还是看-https-github-com-2881099-freesql-blob-master-docs-codefirst-md"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#_3-其他的还是看-https-github-com-2881099-freesql-blob-master-docs-codefirst-md","aria-hidden":"true"}},[this._v("#")]),this._v(" 3. 其他的还是看 https://github.com/2881099/FreeSql/blob/master/Docs/codefirst.md")])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"blog-cs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#blog-cs","aria-hidden":"true"}},[this._v("#")]),this._v(" Blog.cs")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-c# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('using FreeSql.DataAnnotations;\nusing System;\n\nnamespace RESTful.FreeSql.Domain\n{\n    public class Blog\n    {\n        [Column(IsIdentity = true, IsPrimary = true)]\n        public int BlogId { get; set; }\n        [Column(DbType = "varchar(50)")]\n        public string Title { get; set; }\n        [Column(DbType = "varchar(500)")]\n        public string Content { get; set; }\n        public DateTime CreateTime { get; set; }\n\n\n    }\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"post-cs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#post-cs","aria-hidden":"true"}},[this._v("#")]),this._v(" Post.cs")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-C# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('\nusing FreeSql.DataAnnotations;\nusing System;\n\nnamespace RESTful.FreeSql.Domain\n{\n    public class Post\n    {\n        [Column(IsIdentity = true, IsPrimary = true)]\n        public int PostId { get; set; }\n        [Column(DbType = "varchar(50)")]\n        public string ReplyContent { get; set; }\n        public int BlogId { get; set; }\n        public DateTime ReplyTime { get; set; }\n        public Blog Blog { get; set; }\n    }\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"startup-cs"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#startup-cs","aria-hidden":"true"}},[this._v("#")]),this._v(" Startup.cs")])},function(){var t=this.$createElement,e=this._self._c||t;return e("p",[this._v("非全部代码，这里注意点：要先在mysql中创建数据库"),e("strong",[this._v("FreeSql_Blog")]),this._v("，否则一直提示"),e("strong",[this._v("主库xxxxx")]),this._v(",官网未找到相关描述。")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-c# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('namespace RESTful.FreeSql\n{\n    public class Startup\n    {\n        public Startup(IConfiguration configuration)\n        {\n            Fsql = new FreeSqlBuilder()\n                        .UseConnectionString(DataType.MySql, @"Data Source=127.0.0.1;Port=3306;User ID=root;Password=123456;Initial Catalog=FreeSql_Blog;Charset=utf8;SslMode=none;Max pool size=10")\n                        .UseAutoSyncStructure(true)\n                        .Build();\n        }\n\n        public IFreeSql Fsql { get; }\n\n        public void ConfigureServices(IServiceCollection services)\n        {\n            services.AddSingleton<IFreeSql>(Fsql);\n\n        }\n    }\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h4",{attrs:{id:"blogcontroller"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#blogcontroller","aria-hidden":"true"}},[this._v("#")]),this._v(" BlogController")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language-c# extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('using System;\nusing System.Collections.Generic;\nusing System.Linq;\nusing System.Threading.Tasks;\nusing FreeSql;\nusing Microsoft.AspNetCore.Mvc;\nusing RESTful.FreeSql.Domain;\n\nnamespace RESTful.FreeSql.Controllers\n{\n    [Route("api/[controller]")]\n    [ApiController]\n    public class BlogController : ControllerBase\n    {\n        // GET api/Blog\n\n        IFreeSql _fsql;\n        public BlogController(IFreeSql fsql)\n        {\n            _fsql = fsql;\n        }\n\n        [HttpGet]\n        public ActionResult<IEnumerable<Blog>> Get()\n        {\n            List<Blog> blogs = _fsql.Select<Blog>().OrderByDescending(r => r.CreateTime).ToList();\n\n            return blogs;\n        }\n\n        // GET api/blog/5\n        [HttpGet("{id}")]\n        public ActionResult<Blog> Get(int id)\n        {\n            return _fsql.Select<Blog>(id).ToOne();\n        }\n\n\n        // DELETE api/blog/5\n        [HttpDelete("{id}")]\n        public void Delete(int id)\n        {\n            _fsql.Delete<Blog>(new { BlogId = id }).ExecuteAffrows();\n        }\n    }\n}\n')])])])},function(){var t=this.$createElement,e=this._self._c||t;return e("ul",[e("li",[this._v("http://localhost:5001/api/blog， 可看到相应的数据。")]),this._v(" "),e("li",[this._v("http://localhost:5001/api/blog/1  可得到单个数据。")])])},function(){var t=this.$createElement,e=this._self._c||t;return e("h3",{attrs:{id:"自动同步实体结构【开发环境必备】"}},[e("a",{staticClass:"header-anchor",attrs:{href:"#自动同步实体结构【开发环境必备】","aria-hidden":"true"}},[this._v("#")]),this._v(" 自动同步实体结构【开发环境必备】")])},function(){var t=this.$createElement,e=this._self._c||t;return e("div",{staticClass:"language- extra-class"},[e("pre",{pre:!0,attrs:{class:"language-text"}},[e("code",[this._v('Fsql = new FreeSqlBuilder()\n          .UseConnectionString(DataType.MySql, @"连接字符串")\n          .UseAutoSyncStructure(true)\n          .Build();\n                      \n//UseAutoSyncStructure(true/false)【开发环境必备】自动同步实体结构到数据库，程序运行中检查实体表是否存在，然后创建或修改\n\n// 也可使用此方法指定是否自动同步结构。                  \nFsql.CodeFirst.IsAutoSyncStructure = true;\n')])])])}],!1,null,null,null);e.default=a.exports}}]);